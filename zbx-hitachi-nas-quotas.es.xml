<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>3.2</version>
    <date>2017-06-13T09:17:12Z</date>
    <groups>
        <group>
		<name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Plantilla_Hitachi_NAS_Volume_Quotas_Cluster</template>
            <name>Plantilla Hitachi NAS Volume Quotas Cluster (HNASCLUSTER)</name>
            <description/>
            <groups>
                <group>
			<name>Templates</name>
                </group>
	</groups>
	
            <applications>
                <application>
                    <name>Path</name>
                </application>
                <application>
                    <name>Quotas</name>
                </application>
                <application>
                    <name>Quotas - Estadísticas</name>
                </application>
            </applications>
            <items>
{% for vol in volumes %}
                <item>
                    <name>Path de {{vol}}</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid>BLUEARC-TITAN-MIB::virtualVolumeTitanPath.{{fsLabel[vol]}}.{{oid[vol]}}</snmp_oid>
                    <key>VolumeTitanPath[{{vol}}]</key>
                    <delay>86400</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Path</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item>
                <item>
                    <name>Número de quotas de {{vol}}</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid>BLUEARC-TITAN-MIB::virtualVolumeTitanQuotaNumber.{{fsLabel[vol]}}.{{oid[vol]}}</snmp_oid>
                    <key>VolumeTitanQuotaNumber[{{vol}}]</key>
                    <delay>3600</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Quotas - Estadísticas</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item>
{% if has_virtualvolume_quota[vol] %}
                <item>
                    <name>Quotas {{vol}} - Límite de número de ficheros crítico</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid>BLUEARC-TITAN-MIB::virtualVolumeTitanQuotasFileCountCritical.{{fsStatLabel[vol]}}.{{oid[vol]}}.0</snmp_oid>
                    <key>virtualVolumeTitanQuotasFileCountCritical[{{vol}}]</key>
                    <delay>60</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Quotas - Estadísticas</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item>
                <item>
                    <name>Quotas {{vol}} - Número de ficheros usados</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid>BLUEARC-TITAN-MIB::virtualVolumeTitanQuotasFileCount.{{fsStatLabel[vol]}}.{{oid[vol]}}.0</snmp_oid>
                    <key>virtualVolumeTitanQuotasFileCount[{{vol}}]</key>
                    <delay>60</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Quotas - Estadísticas</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item>
                <item>
                    <name>Quotas {{vol}} - Límite crítico de uso</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid>BLUEARC-TITAN-MIB::virtualVolumeTitanQuotasUsageCritical.{{fsStatLabel[vol]}}.{{oid[vol]}}.0</snmp_oid>
                    <key>virtualVolumeTitanQuotasUsageCritical[{{vol}}]</key>
                    <delay>60</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Quotas - Estadísticas</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item>
                <item>
                    <name>Quotas {{vol}} - Uso</name>
                    <type>4</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid>BLUEARC-TITAN-MIB::virtualVolumeTitanQuotasUsage.{{fsStatLabel[vol]}}.{{oid[vol]}}.0</snmp_oid>
                    <key>virtualVolumeTitanQuotasUsage[{{vol}}]</key>
                    <delay>60</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Quotas - Estadísticas</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item>
{% else %}
                <item>
                    <name>Quotas {{vol}} - Sin quota</name>
                    <type>2</type>
                    <snmp_community></snmp_community>
                    <multiplier>0</multiplier>
                    <snmp_oid></snmp_oid>
                    <key>virtualVolumeTitanQuotasVirtualVolumeOff[{{vol}}]</key>
                    <delay>3600</delay>
                    <history>7</history>
                    <trends>365</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <delta>0</delta>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <formula>1</formula>
                    <delay_flex/>
                    <params/>
                    <ipmi_sensor/>
                    <data_type>0</data_type>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>Quotas - Estadísticas</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                </item> 
{% endif %}
{% endfor %}
            </items>
            <discovery_rules/>
            <httptests/>
            <macros/>
            <templates/>
            <screens/>
        </template>
    </templates>
    <triggers>
{% for vol in volumes %}
{% if has_virtualvolume_quota[vol] %}
        <trigger>
            <expression>{Plantilla_Hitachi_NAS_Volume_Quotas_Cluster:virtualVolumeTitanQuotasUsageCritical[{{vol}}].last()}-{Plantilla_Hitachi_NAS_Volume_Quotas_Cluster:virtualVolumeTitanQuotasUsage[{{vol}}].last()}&lt;10</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>{HOSTNAME} MF - Espacio en volumen {{vol}}</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description>Quedan menos de 10MB de la quota (o ya se ha llegado a la misma)</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Plantilla_Hitachi_NAS_Volume_Quotas_Cluster:virtualVolumeTitanQuotasFileCountCritical[{{vol}}].last()}&lt;&gt;0 and {Plantilla_Hitachi_NAS_Volume_Quotas_Cluster:virtualVolumeTitanQuotasFileCountCritical[{{vol}}].last()}-{Plantilla_Hitachi_NAS_Volume_Quotas_Cluster:virtualVolumeTitanQuotasFileCount[{{vol}}].last()}&lt;10</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>{HOSTNAME} MF - Número de ficheros en volumen {{vol}}</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description>Quedan menos de 10 ficheros para que alcance el límite de ficheros (o ya se ha pasado)</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
          </trigger>
{% else %}
        <trigger>
            <expression>{Plantilla_Hitachi_NAS_Volume_Quotas_Cluster:virtualVolumeTitanQuotasVirtualVolumeOff[{{vol}}].nodata(300)}=1</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>{HOSTNAME} MF - Volumen {{vol}} sin quota por volumen</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description>Quedan menos de 10 ficheros para que alcance el límite de ficheros (o ya se ha pasado)</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
          </trigger>
               
{% endif %}
{% endfor %}
    </triggers>
    <value_maps>
        <value_map>
            <name>BlueArc - virtualVolumeTitanQuotasTargetType</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>user</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>group</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>virtualvolume</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>BlueArc - virtualVolumeTitanQuotasType</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>default</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>explicit</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>unknown</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
